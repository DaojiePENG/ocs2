visualization
{
    slowdown     1.0
    vizTime      200
}

model_settings
{
  constrainedIntegration        true

  gravitationalAcceleration     9.81

  contactForceWeight            1.0
  zDirectionPositionWeight      0.0
  zDirectionVelocityWeight      0.5

  enforceFrictionConeConstraint false
  frictionCoefficient           0.7

  enforceTorqueConstraint       false
  torqueLimit                   40.0

  swing_trajectory_settings
  {
    liftOffVelocity             0.2
    touchDownVelocity          -0.4
    swingHeight                 0.1
    touchdownAfterHorizon       0.2
    errorGain                   5.0
    swingTimeScale              0.15
  }

  mpcGoalCommandDelay           0.1

  gaitOptimization              false

  recompileLibraries            true
  algorithm                     SQP
}

terrainPlane
{
  position
  {
    x       0.0;
    y       0.0;
    z       0.0;
  }
  orientation
  {
    roll    0.0;
    pitch   0.0;
    yaw     0.0;
  }
}

initialModeSchedule
{
  modeSequence
  {
    [0]  STANCE
    [1]  STANCE
  }
  eventTimes
  {
    [0]  0.5
  }
}

defaultModeSequenceTemplate
{
  modeSequence
  {
    [0]  STANCE
  }
  switchingTimes
  {
    [0]  0.0
    [1]  1.0
  }
}

; DDP settings
ddp
{
  algorithm                       SLQ

  nThreads                        3
  threadPriority                  50

  maxNumIterations                10
  minRelCost                      0.1
  constraintTolerance             5e-3

  displayInfo                     true
  displayShortSummary             false
  checkNumericalStability         false
  debugPrintRollout               false
  debugCaching                    false

  AbsTolODE                       1e-5
  RelTolODE                       1e-3
  maxNumStepsPerSecond            50000
  minTimeStep                     1e-2
  backwardPassIntegratorType      ODE45

  constraintPenaltyInitialValue   2.0
  constraintPenaltyIncreaseRate   2.0
  inequalityConstraintMu          0.1
  inequalityConstraintDelta       5.0

  preComputeRiccatiTerms          true
  useNominalTimeForBackwardPass   true

  useFeedbackPolicy               true

  riskSensitiveCoeff              0.0

  strategy                        LINE_SEARCH
  lineSearch
  {
      minStepLength                 1e-4
      maxStepLength                 1.0
      hessianCorrectionStrategy     DIAGONAL_SHIFT
      hessianCorrectionMultiple     1e-5
  }
}

; Rollout settings
rollout
{
  AbsTolODE                       1e-5
  RelTolODE                       1e-3
  minTimeStep                     1e-2
  maxNumStepsPerSecond            50000
  checkNumericalStability         false
}

mpc
{
  timeHorizon                     1.0
  numPartitions                   2

  runtimeMaxNumIterations         1
  initMaxNumIterations            10

  runtimeMinStepLength            1e-2
  runtimeMaxStepLength            1.0
  initMinStepLength               1e-2
  initMaxStepLength               1.0

  debugPrint                      false
  coldStart                       false

  useParallelRiccatiSolver        true ; use disjoint riccati solver in multi-thread case

  solutionTimeWindow              -1  ; [s]

  mpcDesiredFrequency             50  ; [Hz]
  mrtDesiredFrequency             400 ; [Hz]
}

; initial state
initialRobotState
{
   ; orientation
   (0,0) 0.0     ; x
   (1,0) 0.0     ; y
   (2,0) 0.0     ; z

   ; position
   (3,0) 0.0         ; x
   (4,0) 0.0         ; y
   (5,0) 0.60174258  ; z

   ; joint state
   (6,0)  -0.25; -0.2      ; LF_HAA
   (7,0)  0.6;  0.723    ; LF_HFE
   (8,0)  -0.85; -1.458    ; LF_KFE
   (9,0)  0.25; -0.2      ; RF_HAA
   (10,0) 0.6;  0.723    ; RF_HFE
   (11,0) -0.85; -1.458    ; RF_KFE
   (12,0) -0.25; -0.2      ; LH_HAA
   (13,0) -0.6; -0.723    ; LH_HFE
   (14,0) 0.85;  1.458    ; LH_KFE
   (15,0) 0.25; -0.2      ; RH_HAA
   (16,0) -0.6; -0.723    ; RH_HFE
   (17,0) 0.85;  1.458    ; RH_KFE

   ; angular velocity
   (18,0) 0.0    ; x
   (19,0) 0.0    ; y
   (20,0) 0.0    ; z

   ; translational velocity
   (21,0) 0.0    ; x
   (22,0) 0.0    ; y
   (23,0) 0.0    ; z

   ; joint velocity
   (24,0) 0.0    ; HAA
   (25,0) 0.0    ; HFE
   (26,0) 0.0    ; KFE
   (27,0) 0.0    ; HAA
   (28,0) 0.0    ; HFE
   (29,0) 0.0    ; KFE
   (30,0) 0.0    ; HAA
   (31,0) 0.0    ; HFE
   (32,0) 0.0    ; KFE
   (33,0) 0.0    ; HAA
   (34,0) 0.0    ; HFE
   (35,0) 0.0    ; KFE
}


tracking_cost_weights
{
    ; Base
    roll                   100.0;
    pitch                  200.0;
    yaw                    200.0;
    base_position_x       1000.0;
    base_position_y       1000.0;
    base_position_z       1500.0;
    base_angular_vel_x       5.0;
    base_angular_vel_y      10.0;
    base_angular_vel_z      10.0;
    base_linear_vel_x       15.0;
    base_linear_vel_y       15.0;
    base_linear_vel_z       30.0;

    ; Per leg
    joint_position_HAA       2.0;
    joint_position_HFE       2.0;
    joint_position_KFE       1.0;
    foot_position_x         60.0;
    foot_position_y         60.0;
    foot_position_z         60.0;
    joint_velocity_HAA      0.02;
    joint_velocity_HFE      0.02;
    joint_velocity_KFE      0.01;
    foot_velocity_x          1.0;
    foot_velocity_y          1.0;
    foot_velocity_z          1.0;
    contact_force_x        0.001;
    contact_force_y        0.001;
    contact_force_z        0.001;
}

