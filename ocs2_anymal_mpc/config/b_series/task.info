model_settings
{
  constrainedIntegration        true

  gravitationalAcceleration     9.81

  contactForceWeight            1.0
  zDirectionPositionWeight      0.0
  zDirectionVelocityWeight      0.5

  enforceFrictionConeConstraint false
  frictionCoefficient           0.7

  enforceTorqueConstraint       false
  torqueLimit                   40.0

  swing_trajectory_settings
  {
    liftOffVelocity             0.2
    touchDownVelocity          -0.4
    swingHeight                 0.1
    touchdownAfterHorizon       0.2
    errorGain                   5.0
    swingTimeScale              0.15
  }

  mpcGoalCommandDelay           0.1

  gaitOptimization              false

  recompileLibraries            true
  algorithm                     SQP
}

terrainPlane
{
  position
  {
    x       0.0;
    y       0.0;
    z       0.0;
  }
  orientation
  {
    roll    0.0;
    pitch   0.0;
    yaw     0.0;
  }
}

initialModeSchedule
{
  modeSequence
  {
    [0]  STANCE
    [1]  STANCE
  }
  eventTimes
  {
    [0]  0.5
  }
}

defaultModeSequenceTemplate
{
  modeSequence
  {
    [0]  STANCE
  }
  switchingTimes
  {
    [0]  0.0
    [1]  1.0
  }
}

; DDP settings
ddp
{
  algorithm                       SLQ

  nThreads                        3
  threadPriority                  50

  maxNumIterations                10
  minRelCost                      0.1
  constraintTolerance             5e-3

  displayInfo                     false
  displayShortSummary             false
  checkNumericalStability         false
  debugPrintRollout               false
  debugCaching                    false

  AbsTolODE                       1e-5
  RelTolODE                       1e-3
  maxNumStepsPerSecond            10000
  minTimeStep                     1e-2
  backwardPassIntegratorType      ODE45

  constraintPenaltyInitialValue   2.0
  constraintPenaltyIncreaseRate   2.0
  inequalityConstraintMu          0.1
  inequalityConstraintDelta       5.0

  preComputeRiccatiTerms          true
  useNominalTimeForBackwardPass   true

  useFeedbackPolicy               true

  riskSensitiveCoeff              0.0

  strategy                        LINE_SEARCH
  lineSearch
  {
      minStepLength                 1e-4
      maxStepLength                 1.0
      hessianCorrectionStrategy     DIAGONAL_SHIFT
      hessianCorrectionMultiple     1e-5
  }
}

; Rollout settings
rollout
{
  AbsTolODE                       1e-5
  RelTolODE                       1e-3
  minTimeStep                     1e-2
  maxNumStepsPerSecond            10000
  checkNumericalStability         false
}

mpc
{
  timeHorizon                     1.0
  numPartitions                   2

  runtimeMaxNumIterations         1
  initMaxNumIterations            10

  runtimeMinStepLength            1e-2
  runtimeMaxStepLength            1.0
  initMinStepLength               1e-2
  initMaxStepLength               1.0

  debugPrint                      false
  coldStart                       false

  useParallelRiccatiSolver        true ; use disjoint riccati solver in multi-thread case

  solutionTimeWindow              -1  ; [s]

  mpcDesiredFrequency             20  ; [Hz]
  mrtDesiredFrequency             400 ; [Hz]
}

; initial state
initialRobotState
{
   ; orientation
   (0,0) 0.0     ; x
   (1,0) 0.0     ; y
   (2,0) 0.0     ; z

   ; position
   (3,0) 0.0     ; x
   (4,0) 0.0     ; y
   (5,0) 0.5163  ; z

   ; joint state
   (6,0)  -0.25       ; LF_HAA
   (7,0)  0.6         ; LF_HFE
   (8,0)  -0.85       ; LF_KFE
   (9,0)  0.25        ; RF_HAA
   (10,0) 0.6         ; RF_HFE
   (11,0) -0.85       ; RF_KFE
   (12,0) -0.25       ; LH_HAA
   (13,0) -0.6        ; LH_HFE
   (14,0) 0.85        ; LH_KFE
   (15,0) 0.25        ; RH_HAA
   (16,0) -0.6        ; RH_HFE
   (17,0) 0.85        ; RH_KFE

   ; angular velocity
   (18,0) 0.0    ; x
   (19,0) 0.0    ; y
   (20,0) 0.0    ; z

   ; translational velocity
   (21,0) 0.0    ; x
   (22,0) 0.0    ; y
   (23,0) 0.0    ; z

   ; joint velocity
   (24,0) 0.0    ; HAA
   (25,0) 0.0    ; HFE
   (26,0) 0.0    ; KFE
   (27,0) 0.0    ; HAA
   (28,0) 0.0    ; HFE
   (29,0) 0.0    ; KFE
   (30,0) 0.0    ; HAA
   (31,0) 0.0    ; HFE
   (32,0) 0.0    ; KFE
   (33,0) 0.0    ; HAA
   (34,0) 0.0    ; HFE
   (35,0) 0.0    ; KFE
}

; state weighting
Q
{
    scaling 1e+0

   ; orientation
   (0,0) 1000.0     ; x
   (1,1) 2000.0     ; y
   (2,2) 2000.0     ; z

   ; positon
   (3,3) 1000.0      ; x
   (4,4) 1000.0      ; y
   (5,5) 1500.0      ; z

   ; angular velocity
   (6,6)   5.0      ; x
   (7,7)  10.0      ; y
   (8,8)  10.0      ; z

   ; translational velocity
   (9,9)    15.0    ; x
   (10,10)  15.0    ; y
   (11,11)  30.0    ; z

   ; LF joints
   (12,12) 20.0 ; LF_HAA
   (13,13) 20.0 ; LF_HFE
   (14,14) 10.0 ; LF_KFE

   ; RF joints
   (15,15) 20.0 ; RF_HAA
   (16,16) 20.0 ; RF_HFE
   (17,17) 10.0 ; RF_KFE

   ; LH joints
   (18,18) 20.0 ; LH_HAA
   (19,19) 20.0 ; LH_HFE
   (20,20) 10.0 ; LH_KFE

   ; RH joints
   (21,21) 20.0 ; RH_HAA
   (22,22) 20.0 ; RH_HFE
   (23,23) 10.0 ; RH_KFE
}

; control weighting
R
{
   scaling 1e-3

   ; LF contact forces
   (0,0)   1.0    ; LF_X
   (1,1)   1.0    ; LF_Y
   (2,2)   1.0    ; LF_Z

   ; RF contact forces
   (3,3)   1.0    ; RF_X
   (4,4)   1.0    ; RF_Y
   (5,5)   1.0    ; RF_Z

   ; LH contact forces
   (6,6)   1.0    ; LH_X
   (7,7)   1.0    ; LH_Y
   (8,8)   1.0    ; LH_Z

   ; RH contact forces
   (9,9)   1.0    ; RH_X
   (10,10) 1.0    ; RH_Y
   (11,11) 1.0    ; RH_Z


   ; LF joint velocities
   (12,12) 1000   ; LF_HAA
   (13,13) 1000   ; LF_HFE
   (14,14) 100    ; LF_KFE

   ; RF joint velocities
   (15,15) 1000    ; RF_HAA
   (16,16) 1000    ; RF_HFE
   (17,17) 100     ; RF_KFE

   ; LH joint velocities
   (18,18) 1000    ; LH_HAA
   (19,19) 1000    ; LH_HFE
   (20,20) 100     ; LH_KFE

   ; RH joint velocities
   (21,21) 1000    ; RH_HAA
   (22,22) 1000    ; RH_HFE
   (23,23) 100     ; RH_KFE
}

; state weighting
Q_final
{
  scaling 1e-1

  ; orientation
  (0,0) 1000.0     ; x
  (1,1) 2000.0     ; y
  (2,2) 2000.0     ; z

  ; position
  (3,3) 1000.0      ; x
  (4,4) 1000.0      ; y
  (5,5) 1500.0      ; z

  ; angular velocity
  (6,6)   5.0      ; x
  (7,7)  10.0      ; y
  (8,8)  10.0      ; z

  ; translational velocity
  (9,9)    15.0    ; x
  (10,10)  15.0    ; y
  (11,11)  30.0    ; z

   ; LF joints
  (12,12) 0.0    ; LF_HAA
  (13,13) 0.0    ; LF_HFE
  (14,14) 0.0    ; LF_KFE

  ; RF joints
  (15,15) 0.0    ; RF_HAA
  (16,16) 0.0    ; RF_HFE
  (17,17) 0.0    ; RF_KFE

  ; LH joints
  (18,18) 0.0    ; LH_HAA
  (19,19) 0.0    ; LH_HFE
  (20,20) 0.0    ; LH_KFE

  ; RH joints
  (21,21) 0.0    ; RH_HAA
  (22,22) 0.0    ; RH_HFE
  (23,23) 0.0    ; RH_KFE
}
